# Q0017: 메인 화면에서 상세 화면 진입 시 적용된 Hero, Fadeout 애니메이션의 공통 모듈화

**날짜**: 2026-03-01
**원본**: [PROPMTS.md](../PROPMTS.md#q0017)

## 질문

1. 메인화면에서 각각의 상세 화면으로 진입할 때 공통적으로 애니메이션이 적용되는데, 이를 공통 모듈화 하는 방안 논의
2. Fadeout의 경우 각 메뉴마다 다른 효과를 적용하고 싶을 수 있기 때문에 이 부분도 고려가 필요

## 답변

### 현재 구조의 문제

`main_screen.dart`에서 계산기가 늘어날수록 아래 코드가 반복됩니다.

```dart
Navigator.of(context).push(
  PageRouteBuilder(
    pageBuilder: (context, animation, secondaryAnimation) => SomeScreen(...),
    transitionDuration: const Duration(milliseconds: 400),
    reverseTransitionDuration: const Duration(milliseconds: 300),
    transitionsBuilder: (context, animation, secondaryAnimation, child) =>
        FadeTransition(
          opacity: CurvedAnimation(parent: animation, curve: Curves.easeInOut),
          child: child,
        ),
  ),
);
```

---

### 모듈화 방안

#### 1. `CalcPageRoute` 커스텀 라우트 클래스 (권장)

`core/navigation/calc_page_route.dart`에 공통 라우트를 정의합니다.

```dart
/// 계산기 화면 전환에 사용하는 공통 라우트
/// [transitionsBuilder]를 생략하면 기본 FadeTransition이 적용됩니다.
class CalcPageRoute<T> extends PageRouteBuilder<T> {
  CalcPageRoute({
    required WidgetBuilder builder,
    RouteTransitionsBuilder? transitionsBuilder,
    Duration transitionDuration = const Duration(milliseconds: 400),
    Duration reverseTransitionDuration = const Duration(milliseconds: 300),
  }) : super(
          pageBuilder: (context, _, __) => builder(context),
          transitionDuration: transitionDuration,
          reverseTransitionDuration: reverseTransitionDuration,
          transitionsBuilder: transitionsBuilder ?? _defaultFade,
        );

  static Widget _defaultFade(
    BuildContext context,
    Animation<double> animation,
    Animation<double> secondaryAnimation,
    Widget child,
  ) {
    return FadeTransition(
      opacity: CurvedAnimation(parent: animation, curve: Curves.easeInOut),
      child: child,
    );
  }
}
```

**사용 예시 — `main_screen.dart`**

```dart
// 기본 Fade (기본 계산기)
Navigator.of(context).push(
  CalcPageRoute(
    builder: (_) => BasicCalculatorScreen(
      title: entry.title,
      icon: entry.icon,
      color: Colors.black.withOpacity(0.2),
    ),
  ),
);

// 다른 효과 (슬라이드 등 메뉴별 커스텀)
Navigator.of(context).push(
  CalcPageRoute(
    builder: (_) => CurrencyCalculatorScreen(
      title: entry.title,
      icon: entry.icon,
    ),
    transitionsBuilder: (context, animation, _, child) =>
        SlideTransition(
          position: Tween(begin: const Offset(0, 0.05), end: Offset.zero)
              .animate(CurvedAnimation(parent: animation, curve: Curves.easeOut)),
          child: FadeTransition(
            opacity: animation,
            child: child,
          ),
        ),
  ),
);
```

---

#### 2. Hero 애니메이션 패턴 (현재 구조 그대로 유지)

Hero는 태그만 일치하면 Flutter가 알아서 처리하므로 별도 모듈화가 불필요합니다. 현재 패턴을 **규칙**으로 정리해두는 것으로 충분합니다.

| 태그 | 카드 (출발) | 상세 화면 (도착) |
|---|---|---|
| `calc_icon_$title` | `CalcModeCard` 아이콘 | 상세 화면 앱바 아이콘 |
| `calc_title_$title` | `CalcModeCard` 타이틀 | 상세 화면 앱바 타이틀 |
| `calc_bg_$title` | `CalcModeCard` 배경 이미지 | (fadeout 처리, 도착 화면에서 미사용) |

새 계산기 화면을 추가할 때 이 세 태그를 앱바에 포함시키는 것이 **규칙**입니다.

---

### 정리

| 구분 | 방안 |
|---|---|
| **Fade 전환 애니메이션** | `CalcPageRoute` 클래스로 공통화, `transitionsBuilder` 파라미터로 메뉴별 커스텀 지원 |
| **Hero 애니메이션** | 태그 네이밍 규칙(`calc_icon_$title`, `calc_title_$title`)으로 통일, 별도 모듈 불필요 |
