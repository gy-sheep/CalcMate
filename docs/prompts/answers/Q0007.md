# Q0007: 메인 화면 목록 구조

**날짜**: 2026-02-27
**원본**: [PROPMTS.md](../PROPMTS.md#q0007)

## 질문

1. 앱의 환경 설정을 통해, 메인 화면에서 보여질 계산기 항목들을 선택할 수 있고, 순서도 변경할 수 있게 구현할 거야. 이 기능을 위해 현재 구현된 코드에서 구조적으로 변경할 부분이 있을까?

## 답변

### 핵심 문제: 현재 구조의 한계

현재 `main_screen.dart`는 **위젯을 직접 하드코딩**하고 있다.

```dart
// 현재: 데이터와 UI가 뒤섞인 구조
final calcCards = [
  CalcModeCard(title: '기본 계산기', onTap: () { Navigator.push(...) }),
  ...
];
```

이 구조에서는 표시 여부나 순서를 런타임에 바꿀 수 없다.

---

### 필요한 구조 변경

**변경 방향: 데이터 ↔ UI 분리**

```
[현재]
MainScreen → CalcModeCard (위젯 목록 하드코딩)

[변경 후]
CalculatorItem (데이터 모델)
       ↓
CalculatorItemsConst (13개 마스터 목록)
       ↓
MainScreenNotifier (Riverpod — 순서/표시 여부 관리, SharedPreferences 연동)
       ↓
MainScreen (ConsumerWidget — 상태 구독 → CalcModeCard 렌더링)
```

---

### 1. 데이터 모델: `CalculatorItem`

```dart
// domain/entities/calculator_item.dart
class CalculatorItem {
  final String id;          // 고유 식별자 (순서 변경에도 불변)
  final String title;
  final String description;
  final IconData icon;
  final String imagePath;
  final bool isVisible;     // 표시 여부
  final int order;          // 표시 순서
}
```

---

### 2. 마스터 목록 상수화

```dart
// core/constants/calculator_items.dart
const kAllCalculatorItems = [
  CalculatorItem(id: 'basic',    title: '기본 계산기', ...),
  CalculatorItem(id: 'exchange', title: '환율 계산기', ...),
  // ... 13개 전체
];
```

---

### 3. 라우팅 분리

`onTap` 로직이 현재 `main_screen.dart`에 직접 박혀 있어 데이터화가 불가능하다. `id` 기반으로 라우팅을 별도 처리해야 한다.

```dart
// core/router/calculator_router.dart
Widget buildScreenFor(String id) {
  switch (id) {
    case 'basic':    return BasicCalculatorScreen(...);
    case 'exchange': return ExchangeRateScreen(...);
    ...
  }
}
```

---

### 4. ViewModel (Riverpod Notifier)

```dart
// presentation/main/main_screen_notifier.dart
class MainScreenNotifier extends Notifier<List<CalculatorItem>> {
  // SharedPreferences에서 순서/표시 여부 로드
  // reorder(oldIndex, newIndex) — 순서 변경 후 저장
  // toggleVisibility(id)       — 표시 여부 변경 후 저장
}
```

---

### 5. MainScreen → ConsumerWidget

```dart
class MainScreen extends ConsumerWidget {
  Widget build(BuildContext context, WidgetRef ref) {
    final items = ref.watch(mainScreenProvider); // 필터/정렬된 목록
    return ListView(
      children: items.map((item) =>
        CalcModeCard(
          ...item,
          onTap: () => Navigator.push(context, buildScreenFor(item.id)),
        )
      ).toList(),
    );
  }
}
```

---

### 변경 대상 파일 요약

| 파일 | 작업 |
|------|------|
| `domain/entities/calculator_item.dart` | 신규 — 데이터 모델 |
| `core/constants/calculator_items.dart` | 신규 — 13개 마스터 목록 |
| `core/router/calculator_router.dart` | 신규 — id → 화면 매핑 |
| `presentation/main/main_screen_notifier.dart` | 신규 — ViewModel |
| `presentation/main/main_screen.dart` | 수정 — ConsumerWidget, 하드코딩 제거 |

이 구조는 **Phase 0 의존성 설정(Riverpod) 완료 후** 함께 진행하는 게 자연스럽다.
