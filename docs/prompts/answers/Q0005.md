# Q0005: Google Play, App Store에 앱 등록

**날짜**: 2026-03-02
**원본**: [PROPMTS.md](../PROPMTS.md#q0005)

## 질문

1. 무료 버전 출시 후, 나중에 기능 차이가 있는 유료 버전을 등록 할 수 있는지
2. 무료 버전, 유료 버전 구분을 위해 앱에서 어떤 처리를 해야 하는지
3. 유료 버전의 경우 일회성 판매와 구독형이 있는데 앱에서 어떤 부분을 처리해야 하는지
4. Google Play 앱 등록 절차
5. App Store 앱 등록 절차

## 답변

### 1. 무료 → 유료 버전 병행 등록 가능 여부

**가능합니다.** 두 가지 방식이 있습니다.

| 방식 | 설명 | 권장 여부 |
|------|------|-----------|
| **별도 앱으로 등록** | 무료 앱과 유료 앱을 각각 다른 패키지명으로 스토어에 등록 | 관리 복잡, 비추천 |
| **단일 앱 + 인앱 결제** | 하나의 앱에 무료/유료 기능을 구분하여 인앱 결제로 잠금 해제 | **권장** |

단일 앱 방식이 사용자 경험이 좋고 유지보수도 쉽습니다.

---

### 인앱 결제(In-App Purchase)란?

**인앱 결제 = 앱 안에서 결제가 일어나는 모든 것**

```
앱 다운로드 (무료)
    │
    ├─ 기본 기능 → 무료로 사용
    │
    └─ 프로 기능 → 잠겨있음 🔒
            │
            └─ 앱 안에서 결제 → 잠금 해제 🔓
```

CalcMate에 대입하면:

| 구분 | 예시 |
|------|------|
| **무료 (기본)** | 기본 계산기, 환율 계산기 등 일부 계산기만 사용 가능 |
| **유료 (프로)** | 나머지 계산기 전체 잠금 해제 |
| **결제 방식** | 앱 내 "프로 버전 구매" 버튼 → 스토어 결제 창 → 완료 |

---

### 2. 앱 내 무료/유료 구분 처리

Flutter에서는 **`in_app_purchase`** 패키지로 처리합니다.

**기본 흐름:**
```
앱 실행 → 구매 상태 확인 → isPremium 여부 판단 → UI 분기
```

**상태 관리 예시 (Riverpod):**
```dart
// 구매 상태를 SharedPreferences 또는 서버에 저장
final isPremiumProvider = StateProvider<bool>((ref) => false);

// 화면에서 분기
if (ref.watch(isPremiumProvider)) {
  // 유료 기능 노출
} else {
  // 잠금 UI + 업그레이드 유도
}
```

**구매 상태 검증 순서:**
1. 앱 시작 시 `in_app_purchase`로 기존 구매 복원 (`restorePurchases`)
2. 구매 확인되면 `isPremium = true` 저장
3. 앱 재설치 시에도 복원 가능 (스토어 계정 기반)

---

### 3. 일회성 판매 vs 구독형 처리

| 구분 | 스토어 상품 유형 | 특징 |
|------|----------------|------|
| **일회성** | `non-consumable` | 한 번 구매 후 영구 사용. 재설치 시 복원 가능 |
| **구독형** | `auto-renewable subscription` | 월/연 갱신. 해지 시 기능 비활성화 |

**일회성 vs 구독 차이:**

| | 일회성 (`₩9,900 한 번`) | 구독 (`₩1,900/월`) |
|--|--|--|
| 결제 | 한 번만 | 매달/매년 자동 갱신 |
| 해지 | 없음 (영구 사용) | 해지 시 기능 비활성화 |
| 적합한 앱 | 계산기, 유틸리티류 | 스트리밍, 클라우드, 뉴스 |

**CalcMate에 적합한 방식:** 계산기 앱 특성상 **일회성 구매**가 자연스럽습니다. 사용자 입장에서 "계산기를 구독한다"는 개념이 어색하기도 합니다.

**`in_app_purchase` 패키지 핵심 코드:**
```dart
// pubspec.yaml
// in_app_purchase: ^3.x.x

final InAppPurchase _iap = InAppPurchase.instance;

// 상품 조회
final ProductDetailsResponse response =
    await _iap.queryProductDetails({'calcmate_premium'});

// 구매 시작 (일회성)
final PurchaseParam param =
    PurchaseParam(productDetails: response.productDetails.first);
_iap.buyNonConsumable(purchaseParam: param);

// 구매 결과 스트림 처리
_iap.purchaseStream.listen((purchases) {
  for (final purchase in purchases) {
    if (purchase.status == PurchaseStatus.purchased) {
      // 검증 후 isPremium = true
    }
  }
});
```

---

### 4. Google Play 앱 등록 절차

**사전 준비:**
- Google Play Console 개발자 계정 (최초 1회 $25 등록비)
- 앱 아이콘, 스크린샷, 설명문 준비

**등록 순서:**

```
1. play.google.com/console → 앱 만들기
2. 앱 정보 입력
   - 앱 이름, 기본 언어, 앱/게임 구분, 유무료 구분
3. 스토어 등록정보 작성
   - 짧은 설명 (80자), 전체 설명 (4000자)
   - 스크린샷 (최소 2장, 권장 8장)
   - 기능 그래픽 이미지 (1024×500px)
4. 콘텐츠 등급 설정 (설문 작성)
5. 타겟 독자 및 콘텐츠 설정
6. 앱 서명 설정 (Google Play 앱 서명 권장)
7. APK/AAB 업로드
   - flutter build appbundle --release
   - app/build/outputs/bundle/release/app-release.aab 업로드
8. 출시 트랙 선택 → 내부 테스트 → 비공개 테스트 → 공개 테스트 → 프로덕션
9. 검토 제출 (보통 1~3일 소요)
```

**Flutter 릴리즈 빌드:**
```bash
# keystore 생성 (최초 1회)
keytool -genkey -v -keystore ~/upload-keystore.jks \
  -keyalg RSA -keysize 2048 -validity 10000 -alias upload

# key.properties 설정 후
flutter build appbundle --release
```

---

### 5. App Store 앱 등록 절차

**사전 준비:**
- Apple Developer Program 가입 (연 $99)
- Mac + Xcode 필수
- App Store Connect 접근 권한

**등록 순서:**

```
1. appstoreconnect.apple.com → 나의 앱 → + → 신규 앱
2. 앱 정보 입력
   - 플랫폼: iOS
   - 이름, 기본 언어, 번들 ID (Xcode에서 설정한 값)
   - SKU (내부 식별자, 임의 문자열)
3. App Store 등록정보 작성
   - 스크린샷 (기기 크기별 필요: 6.9", 6.5", 5.5" 등)
   - 설명, 키워드, 지원 URL
4. 앱 심사 정보
   - 로그인 정보 (테스트 계정), 연락처
   - 콘텐츠 권리, 광고 ID 사용 여부
5. 가격 및 사용 가능 여부 설정
6. 빌드 업로드
   - Xcode → Product → Archive → Distribute App
   - 또는 flutter build ipa → Transporter 앱으로 업로드
7. 빌드 선택 후 제출
8. 심사 대기 (보통 1~3일, 거절 시 이유 통보)
```

**Flutter IPA 빌드:**
```bash
flutter build ipa --release
# build/ios/ipa/*.ipa 생성
```

---

### 요약

- 단일 앱 + 인앱 결제(`in_app_purchase`) 방식 권장
- CalcMate는 **일회성 구매**가 적합 (계산기 앱에 구독은 어색)
- 일회성 구매면 `buyNonConsumable`, 구독이면 구독 상품 타입 사용
- Google Play: AAB 업로드, $25 일회성
- App Store: IPA 업로드, 연 $99
