# 환율 계산기 스펙

> **Phase**: `Phase 2`
> **한 줄 설명**: 두 통화 간 금액을 실시간으로 환산하고, 수식 입력도 지원하는 환율 계산기

---

## 개요

사용자가 출발 통화(From)와 도착 통화(To)를 선택하고 금액을 입력하면 실시간으로 환산 결과를 표시한다.
수식 입력(`100 + 50 =`)이 가능하여 복잡한 금액 계산 후 환산도 지원한다.
환율 데이터는 외부 API에서 주기적으로 조회하며, 오프라인 환경에서는 마지막으로 캐시된 환율을 사용한다.

---

## 화면 구성

```
┌──────────────────────────────────┐
│  ← [아이콘] 환율 계산기          │  ← 앱바 (Hero 애니메이션)
├──────────────────────────────────┤
│                                  │
│  USD ▾              120          │  ← From 통화 행 (탭: 통화 선택)
│                  ──────────────  │  ← 활성 밑줄 (흰색)
│                                  │
│            ↕ (스왑 버튼)         │
│                                  │
│  EUR ▾              110.04       │  ← To 통화 행 (탭: 통화 선택)
│                  ──────────────  │  ← 비활성 밑줄 (흰색 38%)
│                                  │
├──────────────────────────────────┤
│ ─────────────────────────────── │  ← 구분선
│  ⌫  │  AC  │  %  │  ÷          │
│  7  │   8  │  9  │  ×          │
│  4  │   5  │  6  │  -          │
│  1  │   2  │  3  │  +          │
│ +/- │   0  │  .  │  =          │
└──────────────────────────────────┘
```

**테마**: 다크 그라디언트 (딥 네이비 → 틸)

---

## 기능 요구사항

### 통화 선택

- From/To 각각 통화 코드(예: `USD ▾`)를 탭하면 통화 선택 Bottom Sheet가 열린다
- Bottom Sheet에서 통화 코드 또는 이름으로 검색할 수 있다
- 현재 선택된 통화는 체크 표시로 구분된다
- 통화를 선택하면 입력값이 `0`으로 초기화되고 환산이 즉시 업데이트된다

### 스왑

- 스왑 버튼(`↕`) 탭 시 From/To 통화가 서로 교환된다
- 스왑 후 입력값은 `0`으로 초기화된다

### 금액 입력

- 키패드는 기본 계산기와 동일한 5×4 레이아웃을 사용한다
- 숫자, 연산자(`÷ × - +`), `%`, `.`, `+/-`, `⌫`, `AC/C`, `=` 모두 기본 계산기와 동일하게 동작한다
- From/To 행을 탭하면 해당 행이 활성화(밑줄 흰색)되고, 키패드 입력이 해당 행에 적용된다
  - 현재는 From 행만 편집 가능 (To 행은 항상 환산 결과 표시)

### 환산 계산

- 입력값이 변경될 때마다 즉시 환산 결과를 계산하여 To 행에 표시한다
- 수식이 완성되지 않은 경우(연산자로 끝나는 경우)에는 `0`을 표시한다
- `=`를 누르면 수식을 평가하고, 그 결과값을 기준으로 환산한다
- 환산 공식: `입력값 ÷ From환율 × To환율` (모든 환율은 KRW 기준)

### 환율 데이터

- 앱 실행 시 자동으로 최신 환율을 API에서 조회한다
- 캐시 유효 기간은 **1시간**이며, 만료 전에는 캐시를 사용한다
- 조회 중에는 목업 환율을 표시하다가 완료 시 자동 업데이트한다

### 지원 통화

| 코드 | 이름 |
|------|------|
| KRW | 한국 원 |
| USD | 미국 달러 |
| JPY | 일본 엔 |
| EUR | 유로 |
| CNY | 중국 위안 |
| GBP | 영국 파운드 |
| AUD | 호주 달러 |
| CAD | 캐나다 달러 |

---

## 금액 표시 규칙

| 조건 | 표시 형식 |
|------|-----------|
| 1,000 이상 | 소수점 없이 정수 표시 (예: `1,234,567`) |
| 1 이상 1,000 미만 | 소수점 2자리 (예: `123.45`) |
| 1 미만 | 소수점 4자리 (예: `0.0007`) |
| 0 | `0` |

---

## 예외 / 엣지 케이스

| 상황 | 기대 동작 |
|------|-----------|
| API 호출 실패 | 캐시된 환율로 fallback, 사용자에게 "마지막 업데이트 시각" 표시 |
| 캐시도 없는 최초 오프라인 실행 | 목업 환율 사용, 안내 메시지 표시 |
| From과 To가 같은 통화 | 입력값과 동일한 값 표시 (1:1 환산) |
| 수식 오류 (예: `0 ÷ 0`) | `오류` 표시, 환산 결과 `0` |

---

## 비기능 요구사항

- **성능**: 입력값 변경 시 환산 결과 즉시 업데이트 (16ms 이내)
- **오프라인**: 캐시된 환율로 동작 가능, 캐시 없을 시 목업 fallback
- **캐시 유효 기간**: 1시간
- **API**: `https://api.frankfurter.app/latest?from=KRW`

---

## 수정 요청

> 개발 중 수정이 필요하다고 느낀 항목을 여기에 기록한다.
> 완료된 항목은 `- [x]`로 체크한다.

<!-- 예시: - [ ] To 행도 직접 편집 가능하도록 변경 필요 — 날짜: 2026-03-01 -->

---

## 참고 / 레퍼런스

- 구현 명세: `docs/dev/EXCHANGE_RATE_CALCULATOR.md`
- 환율 API Q&A: `docs/prompts/answers/` (Q0006 — 미답변)
