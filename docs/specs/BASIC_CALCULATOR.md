# 기본 계산기 스펙

> **Phase**: `Phase 1`
> **한 줄 설명**: 일상적인 사칙연산을 iOS 계산기와 동일한 UX로 제공하는 기본 계산기

---

## 개요

사용자가 숫자와 연산자를 순서대로 입력하면 수식을 조합하고, `=`를 누르는 시점에 결과를 계산하여 표시한다.
iOS 기본 계산기의 동작 방식을 기준으로 하며, `%`의 컨텍스트 계산, `=` 반복, AC/C 전환 등 세부 UX를 동일하게 구현한다.

---

## 화면 구성

```
┌─────────────────────────────────┐
│  ← [아이콘] 기본 계산기         │  ← 앱바 (Hero 애니메이션)
├─────────────────────────────────┤
│                                 │
│           (수식 표시)           │  ← 계산 완료 후에만 표시 (회색, 소형)
│                                 │
│              1,234              │  ← 메인 입력/결과 (흰색, 대형 / 동적 폰트)
│  ─────────────────────────────  │  ← 밑줄
│                                 │
├─────────────────────────────────┤
│  ⌫  │  AC  │  %  │  ÷         │
│  7  │   8  │  9  │  ×         │
│  4  │   5  │  6  │  -         │
│  1  │   2  │  3  │  +         │
│ +/- │   0  │  .  │  =         │  ← = 버튼은 주황색 배경
└─────────────────────────────────┘
```

**테마**: 다크 그라디언트 (딥 네이비 → 다크 그린)

---

## 기능 요구사항

### 숫자 입력

- 숫자 버튼(0~9) 탭 시 현재 입력값에 해당 숫자를 추가한다
- 초기 상태(`0`)에서 숫자를 누르면 `0`을 대체한다 (`01` 방지)
- 계산 완료 상태(`isResult`)에서 숫자를 누르면 새 수식으로 시작한다

### 연산자 입력 (`÷ × - +`)

- 현재 입력값 끝에 연산자를 추가하여 수식을 이어간다
- 연산자가 이미 맨 끝에 있으면 새 연산자로 교체한다 (연속 입력 시 마지막 연산자 유효)
- 초기 상태(`0`)에서 `-`를 누르면 음수 입력 모드로 진입한다 (`-` 표시)
- 계산 완료 상태에서 연산자를 누르면 결과값에 이어 수식을 이어간다

### 소수점 (`.`)

- 현재 숫자 세그먼트에 소수점이 없을 때만 추가한다 (중복 방지)
- 연산자 바로 뒤에서 `.`를 누르면 `0.`으로 시작한다
- 계산 완료 상태에서 `.`를 누르면 `0.`으로 새 입력을 시작한다

### 부호 전환 (`+/-`)

- 현재 마지막 숫자 세그먼트의 부호를 전환한다
- 수식 중간 숫자에도 적용된다 (예: `100+50` → `+/-` → `100+-50`)

### 퍼센트 (`%`)

- 현재 입력 끝에 `%` 기호를 추가한다
- `=` 시점에 컨텍스트 기반으로 계산한다:
  - `A + B%` → `A + (A × B / 100)` (앞 숫자 기준 퍼센트)
  - `A - B%` → `A - (A × B / 100)`
  - `A × B%` 또는 단독 `B%` → `B ÷ 100`
- 연산자 바로 뒤, 또는 이미 `%`가 있을 때는 입력을 무시한다

### 백스페이스 (`⌫`)

- 마지막 입력 문자를 한 글자씩 제거한다
- 입력값이 한 자리이면 `0`으로 초기화한다
- 계산 완료 상태에서 `⌫`를 누르면 전체 초기화(`0`)한다

### 클리어 (`AC` / `C`)

- **AC**: 입력값 전체를 초기화하여 `0`으로 돌아간다
- **C**: 현재 세그먼트(연산자 이후 입력한 숫자)만 지운다. 전 세그먼트까지 지우면 연산자만 남는다
- **AC/C 전환 조건**: 입력값이 `0` 또는 `-`이거나 연산자만 있는 상태면 `AC`, 그 외에는 `C` 표시

### 계산 (`=`)

- 수식을 평가하여 결과를 표시하고, 수식은 작게 위에 표시한다
- 결과 상태에서 `=`를 반복하면 마지막 연산자와 피연산자를 재적용한다 (반복 `=`)
  - 예: `5 + 3 =` → `8`, 다시 `=` → `11`, 다시 `=` → `14`

---

## 표시 규칙

- **천 단위 콤마**: 숫자에 자동 적용 (예: `1234567` → `1,234,567`)
- **음수 괄호 표시**: 수식 내 음수는 괄호로 표시 (예: `100+(-50)`)
- **동적 폰트**: 숫자가 길어질수록 폰트 크기 자동 축소 (최대 80pt, 최소 10pt)
- **오른쪽 고정 스크롤**: 폰트 축소 한계 초과 시 오른쪽 기준으로 스크롤

---

## 예외 / 엣지 케이스

| 상황 | 기대 동작 |
|------|-----------|
| `0 ÷ 0` | `오류` 표시 |
| 연산자만 입력된 상태에서 `=` | 계산하지 않고 무시 |
| 매우 긴 소수 결과 | 불필요한 trailing 0 제거, 최대 10자리 |
| `-0` 상태 | `0`으로 표시 |
| 결과가 정수인 경우 | 소수점 없이 표시 (예: `3.0` → `3`) |

---

## 비기능 요구사항

- **성능**: 버튼 탭 후 표시 업데이트 즉시 (16ms 이내)
- **오프라인**: 네트워크 불필요, 완전 오프라인 동작
- **상태 유지**: 앱 종료 후 상태 초기화 (히스토리 저장은 Phase 14)

---

## 수정 요청

> 개발 중 수정이 필요하다고 느낀 항목을 여기에 기록한다.
> 완료된 항목은 `- [x]`로 체크한다.

<!-- 예시: - [ ] 결과 표시 후 수식이 너무 작아서 잘 안보임 — 날짜: 2026-03-01 -->

---

## 참고 / 레퍼런스

- iOS 기본 계산기 동작 방식 기준
- 구현 명세: `docs/dev/BASIC_CALCULATOR.md`
